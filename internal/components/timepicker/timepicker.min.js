(()=>{(function(){function q(t){if(!t||typeof t!="string")return null;let e=t.match(/^(\d{1,2}):(\d{2})$/);if(!e)return null;let r=parseInt(e[1],10),i=parseInt(e[2],10);return r<0||r>23||i<0||i>59?null:{hour:r,minute:i}}function g(t,e,r){if(r){let i=t>=12?"PM":"AM";return`${(t===0?12:t>12?t-12:t).toString().padStart(2,"0")}:${e.toString().padStart(2,"0")} ${i}`}return`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}function x(t,e){return`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}function y(t,e,r,i){if(!r&&!i)return!0;let u=t*60+e;if(r){let a=r.hour*60+r.minute;if(u<a)return!1}if(i){let a=i.hour*60+i.minute;if(u>a)return!1}return!0}function E(t,e,r,i){if(!r&&!i)return!0;for(let u=0;u<60;u++)if(y(t,u,r,i))return!0;return!1}function D(t,e,r,i,u,a){t.querySelectorAll("[data-tui-timepicker-hour]").forEach(s=>{let d=parseInt(s.getAttribute("data-tui-timepicker-hour")),m=!1;e!==null&&(r?m=d===e||d===0&&e===12||d===e-12&&e>12:m=d===e);let v=r&&d===0?e>=12?12:0:d,n=E(v,i,u,a);s.setAttribute("data-tui-timepicker-selected",m?"true":"false"),s.disabled=!n,n?s.classList.remove("opacity-50","cursor-not-allowed"):s.classList.add("opacity-50","cursor-not-allowed")})}function z(t,e,r,i,u){t.querySelectorAll("[data-tui-timepicker-minute]").forEach(a=>{let s=parseInt(a.getAttribute("data-tui-timepicker-minute")),d=s===e,m=r===null||y(r,s,i,u);a.setAttribute("data-tui-timepicker-selected",d?"true":"false"),a.disabled=!m,m?a.classList.remove("opacity-50","cursor-not-allowed"):a.classList.add("opacity-50","cursor-not-allowed")})}function H(t,e){let r=t.querySelector('[data-tui-timepicker-period="AM"]'),i=t.querySelector('[data-tui-timepicker-period="PM"]');if(!r||!i)return;let u=e===null||e<12;r.setAttribute("data-tui-timepicker-active",u?"true":"false"),i.setAttribute("data-tui-timepicker-active",u?"false":"true")}function U(t,e,r,i,u){let a=t.querySelector("[data-tui-timepicker-display]");if(a)if(e!==null&&r!==null){let s=g(e,r,i);a.textContent=s,a.classList.remove("text-muted-foreground")}else a.textContent=u,a.classList.add("text-muted-foreground")}function O(t,e,r){let i=t.querySelector("[data-tui-timepicker-hidden-input]");i&&(e!==null&&r!==null?i.value=x(e,r):i.value="")}function w(t){if(!t||t.hasAttribute("data-tui-timepicker-initialized"))return;t.setAttribute("data-tui-timepicker-initialized","true");let e=t.id,r=e+"-content",i=t.getAttribute("data-tui-timepicker-use12hours")==="true",u=t.getAttribute("data-tui-timepicker-am-label")||"AM",a=t.getAttribute("data-tui-timepicker-pm-label")||"PM",s=t.getAttribute("data-tui-timepicker-placeholder")||"Select time",d=parseInt(t.getAttribute("data-tui-timepicker-step")||"1",10),m=t.getAttribute("data-tui-timepicker-min-time")||"",v=t.getAttribute("data-tui-timepicker-max-time")||"",n=null,c=null,k=m?q(m):null,S=v?q(v):null,T=document.getElementById(r);if(!T){console.error("TimePicker init error: Missing popup content.",{timePickerID:e,popupId:r});return}let A=T.querySelector("[data-tui-timepicker-popup]"),I=A?.querySelector("[data-tui-timepicker-hour-list]"),L=A?.querySelector("[data-tui-timepicker-minute-list]"),P=A?.querySelector("[data-tui-timepicker-done]");if(!A||!I||!L||!P){console.error("TimePicker init error: Missing required elements.",{timePickerID:e,popup:A,hourList:I,minuteList:L,doneButton:P});return}let C=A.getAttribute("data-tui-timepicker-value");if(C){let o=q(C);o&&(n=o.hour,c=o.minute)}function M(){U(t,n,c,i,s),O(A,n,c),D(I,n,i,c,k,S),z(L,c,n,k,S),i&&H(A,n)}I.addEventListener("click",o=>{let p=o.target.closest("[data-tui-timepicker-hour]");if(!p||p.disabled)return;let l=parseInt(p.getAttribute("data-tui-timepicker-hour"),10);if(i){let f=n!==null&&n>=12;l===0?l=f?12:0:l=f?l+12:l}if(E(l,c,k,S)){if(n=l,c!==null&&!y(n,c,k,S)){let f=null;for(let b=0;b<60;b+=d)if(y(n,b,k,S)){f=b;break}c=f}M()}}),L.addEventListener("click",o=>{let p=o.target.closest("[data-tui-timepicker-minute]");if(!p||p.disabled)return;let l=parseInt(p.getAttribute("data-tui-timepicker-minute"),10);n!==null&&!y(n,l,k,S)||(c=l,M())}),i&&A.addEventListener("click",o=>{let p=o.target.closest("[data-tui-timepicker-period]");if(!p)return;let l=p.getAttribute("data-tui-timepicker-period");if(n===null)return;let f=n;if(l==="AM"?n>=12&&(f=n===12?0:n-12):l==="PM"&&n<12&&(f=n===0?12:n+12),!!E(f,c,k,S)){if(n=f,c!==null&&!y(n,c,k,S)){let b=null;for(let h=0;h<60;h+=d)if(y(n,h,k,S)){b=h;break}c=b}M()}}),P.addEventListener("click",()=>{let o=t.closest("[data-tui-popover]")?.querySelector("[data-tui-popover-trigger]");o instanceof HTMLElement?o.click():t.click()}),M();let V=t.closest("form");V&&V.addEventListener("reset",()=>{n=null,c=null,M()}),t._timePickerCleanup=()=>{}}function $(t=document){t instanceof Element&&t.matches('[data-tui-timepicker="true"]')&&w(t),t.querySelectorAll('[data-tui-timepicker="true"]:not([data-tui-timepicker-initialized])').forEach(e=>{w(e)})}window.templUI=window.templUI||{},window.templUI.timePicker={init:$},document.addEventListener("DOMContentLoaded",()=>$())})();})();
