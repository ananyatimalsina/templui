(()=>{typeof window.inputOTPState>"u"&&(window.inputOTPState=new WeakMap);(function(){if(window.inputOTPSystemInitialized)return;function p(a){if(window.inputOTPState.has(a))return;let l=a.querySelector("[data-input-otp-value-target]"),n=Array.from(a.querySelectorAll("[data-input-otp-slot]")).sort((t,e)=>parseInt(t.dataset.inputIndex)-parseInt(e.dataset.inputIndex));if(!l||n.length===0)return;a.hasAttribute("autofocus")&&requestAnimationFrame(()=>{let t=n[0];t&&(t.focus(),t.select())});let s=()=>{l.value=n.map(t=>t.value).join("")},f=()=>n.findIndex(t=>!t.value),u=t=>{t>=0&&t<n.length&&(n[t].focus(),setTimeout(()=>n[t].select(),0))},v=t=>{let e=t.target,i=parseInt(e.dataset.inputIndex);if(e.value===" "){e.value="";return}e.value.length>1&&(e.value=e.value.slice(-1)),e.value&&i<n.length-1&&u(i+1),s()},w=t=>{let e=t.target,i=parseInt(e.dataset.inputIndex);if(t.key==="Backspace"){let o=e.value;i>0&&(t.preventDefault(),o?(e.value="",s(),u(i-1)):(n[i-1].value="",s(),u(i-1)))}else t.key==="ArrowLeft"&&i>0?(t.preventDefault(),u(i-1)):t.key==="ArrowRight"&&i<n.length-1&&(t.preventDefault(),u(i+1))},I=t=>{let e=t.target,i=parseInt(e.dataset.inputIndex),o=f();if(o!==-1&&i!==o){u(o);return}setTimeout(()=>e.select(),0)},h=t=>{t.preventDefault();let i=(t.clipboardData||window.clipboardData).getData("text").replace(/\s/g,"").split(""),o=0,g=n.find(r=>r===document.activeElement);g&&(o=parseInt(g.dataset.inputIndex));for(let r=0;r<i.length&&o<n.length;r++)n[o].value=i[r],o++;s();let d=f();d===-1?d=n.length-1:d>0&&d>o&&(d=o),u(Math.min(d,n.length-1))};for(let t of n)t.addEventListener("input",v),t.addEventListener("keydown",w),t.addEventListener("focus",I);a.addEventListener("paste",h);let m=l.id;if(m){for(let t of document.querySelectorAll(`label[for="${m}"]`))if(!t.dataset.inputOtpListener){let e=i=>{i.preventDefault(),n.length>0&&u(0)};t.addEventListener("click",e),t.dataset.inputOtpListener="true",t._inputOtpClickListener=e}}if(a.dataset.value){let t=a.dataset.value;for(let e=0;e<n.length&&e<t.length;e++)n[e].value=t[e];s()}let O={slots:n,hiddenInput:l,handleInput:v,handleKeydown:w,handleFocus:I,handlePaste:h};window.inputOTPState.set(a,O)}function L(a){let l=window.inputOTPState.get(a);if(!l)return;for(let s of l.slots)s.removeEventListener("input",l.handleInput),s.removeEventListener("keydown",l.handleKeydown),s.removeEventListener("focus",l.handleFocus);a.removeEventListener("paste",l.handlePaste);let n=l.hiddenInput.id;if(n)for(let s of document.querySelectorAll(`label[for="${n}"]`))s._inputOtpClickListener&&(s.removeEventListener("click",s._inputOtpClickListener),delete s._inputOtpClickListener,delete s.dataset.inputOtpListener);window.inputOTPState.delete(a)}function c(a=document){a instanceof Element&&a.matches("[data-input-otp]")&&p(a),a.querySelectorAll("[data-input-otp]").forEach(p)}window.templUI=window.templUI||{},window.templUI.inputOTP={init:c,cleanup:L},document.addEventListener("DOMContentLoaded",()=>c()),window.inputOTPSystemInitialized=!0})();})();
