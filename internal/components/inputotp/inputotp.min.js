(()=>{typeof window.inputOTPState>"u"&&(window.inputOTPState=new WeakMap);(function(){if(window.inputOTPSystemInitialized)return;function c(a){if(window.inputOTPState.has(a))return;let i=a.querySelector("[data-input-otp-value-target]"),n=Array.from(a.querySelectorAll("[data-input-otp-slot]")).sort((t,e)=>parseInt(t.dataset.inputIndex)-parseInt(e.dataset.inputIndex));if(!i||n.length===0)return;a.hasAttribute("autofocus")&&requestAnimationFrame(()=>{let t=n[0];t&&(t.focus(),t.select())});let o=()=>{i.value=n.map(t=>t.value).join("")},m=()=>n.findIndex(t=>!t.value),d=t=>{t>=0&&t<n.length&&(n[t].focus(),setTimeout(()=>n[t].select(),0))},h=t=>{let e=t.target,s=parseInt(e.dataset.inputIndex);if(e.value===" "){e.value="";return}e.value.length>1&&(e.value=e.value.slice(-1)),e.value&&s<n.length-1&&d(s+1),o()},w=t=>{let e=t.target,s=parseInt(e.dataset.inputIndex);if(t.key==="Backspace"){let l=e.value;s>0&&(t.preventDefault(),l?(e.value="",o(),d(s-1)):(n[s-1].value="",o(),d(s-1)))}else t.key==="ArrowLeft"&&s>0?(t.preventDefault(),d(s-1)):t.key==="ArrowRight"&&s<n.length-1&&(t.preventDefault(),d(s+1))},I=t=>{let e=t.target,s=parseInt(e.dataset.inputIndex),l=m();if(l!==-1&&s!==l){d(l);return}setTimeout(()=>e.select(),0)},g=t=>{t.preventDefault();let s=(t.clipboardData||window.clipboardData).getData("text").replace(/\s/g,"").split(""),l=0,S=n.find(r=>r===document.activeElement);S&&(l=parseInt(S.dataset.inputIndex));for(let r=0;r<s.length&&l<n.length;r++)n[l].value=s[r],l++;o();let u=m();u===-1?u=n.length-1:u>0&&u>l&&(u=l),d(Math.min(u,n.length-1))};for(let t of n)t.addEventListener("input",h),t.addEventListener("keydown",w),t.addEventListener("focus",I);a.addEventListener("paste",g);let L=i.id;if(L){for(let t of document.querySelectorAll(`label[for="${L}"]`))if(!t.dataset.inputOtpListener){let e=s=>{s.preventDefault(),n.length>0&&d(0)};t.addEventListener("click",e),t.dataset.inputOtpListener="true",t._inputOtpClickListener=e}}if(a.dataset.value){let t=a.dataset.value;for(let e=0;e<n.length&&e<t.length;e++)n[e].value=t[e];o()}let y={slots:n,hiddenInput:i,handleInput:h,handleKeydown:w,handleFocus:I,handlePaste:g};window.inputOTPState.set(a,y)}function p(a){let i=window.inputOTPState.get(a);if(!i)return;for(let o of i.slots)o.removeEventListener("input",i.handleInput),o.removeEventListener("keydown",i.handleKeydown),o.removeEventListener("focus",i.handleFocus);a.removeEventListener("paste",i.handlePaste);let n=i.hiddenInput.id;if(n)for(let o of document.querySelectorAll(`label[for="${n}"]`))o._inputOtpClickListener&&(o.removeEventListener("click",o._inputOtpClickListener),delete o._inputOtpClickListener,delete o.dataset.inputOtpListener);window.inputOTPState.delete(a)}function f(a=document){a instanceof Element&&a.matches("[data-input-otp]")&&c(a),a.querySelectorAll("[data-input-otp]").forEach(c)}let v=a=>{let i=a.detail.target||a.detail.elt;i instanceof Element&&requestAnimationFrame(()=>f(i))};document.addEventListener("DOMContentLoaded",()=>f()),document.body.addEventListener("htmx:beforeSwap",a=>{let i=a.detail.target||a.detail.elt;if(i instanceof Element&&(i.matches&&i.matches("[data-input-otp]")&&p(i),i.querySelectorAll))for(let n of i.querySelectorAll("[data-input-otp]"))p(n)}),document.body.addEventListener("htmx:afterSwap",v),document.body.addEventListener("htmx:oobAfterSwap",v),window.inputOTPSystemInitialized=!0})();})();
