(()=>{typeof window.ratingState>"u"&&(window.ratingState=new WeakMap);(function(){function v(e){if(!e)return;let o=window.ratingState.get(e);o&&b(e,o),e.dataset.ratingInitialized="true";let a={value:parseFloat(e.dataset.initialValue)||0,precision:parseFloat(e.dataset.precision)||1,readonly:e.dataset.readonly==="true",name:e.dataset.name||"",onlyInteger:e.dataset.onlyinteger==="true",maxValue:0},l=e.querySelector("[data-rating-input]"),s=Array.from(e.querySelectorAll("[data-rating-item]")),r=a.value,u=0,f={click:x,mouseover:I,mouseleave:S};function p(){let n=0;for(let t of s){let i=parseInt(t.dataset.ratingValue,10);!isNaN(i)&&i>n&&(n=i)}a.maxValue=Math.max(1,n),r=Math.max(0,Math.min(a.maxValue,r)),r=Math.round(r/a.precision)*a.precision,h()}function h(){l&&(l.value=r.toFixed(2))}function c(n){for(let t of s){let i=parseInt(t.dataset.ratingValue,10);if(isNaN(i))continue;let w=t.querySelector("[data-rating-item-foreground]");if(!w)continue;let d=n>0?n:r,M=i<=Math.floor(d),V=!M&&i-1<d&&d<i,L=V?(d-Math.floor(d))*100:0;w.style.width=M?"100%":V?`${L}%`:"0%"}}function g(n){if(a.readonly)return;let t=n;a.onlyInteger?t=Math.round(t):r===t&&t%1===0?t=Math.max(0,t-a.precision):t=Math.round(t/a.precision)*a.precision,r=Math.max(0,Math.min(a.maxValue,t)),u=0,h(),c(0),e.dispatchEvent(new CustomEvent("rating-change",{bubbles:!0,detail:{name:a.name,value:r,maxValue:a.maxValue}})),l&&(l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0})))}function I(n){if(a.readonly)return;let t=n.target.closest("[data-rating-item]");t&&(u=parseInt(t.dataset.ratingValue,10),isNaN(u)||c(u))}function S(){a.readonly||(u=0,c(0))}function x(n){if(a.readonly)return;let t=n.target.closest("[data-rating-item]");if(!t)return;let i=parseInt(t.dataset.ratingValue,10);isNaN(i)||g(i)}if(p(),c(0),a.readonly){e.style.cursor="default";for(let n of s)n.style.cursor="default"}else e.addEventListener("click",f.click),e.addEventListener("mouseover",f.mouseover),e.addEventListener("mouseleave",f.mouseleave);let y=new MutationObserver(()=>{try{e.querySelectorAll("[data-rating-item]").length!==s.length&&(s=Array.from(e.querySelectorAll("[data-rating-item]")),p(),c(u>0?u:0))}catch(n){console.error("Error in rating MutationObserver:",n)}});y.observe(e,{childList:!0,subtree:!0});let A={handlers:f,observer:y,items:s};window.ratingState.set(e,A)}function b(e,o){!e||!o||(!e.dataset.readonly==="true"&&(e.removeEventListener("click",o.handlers.click),e.removeEventListener("mouseover",o.handlers.mouseover),e.removeEventListener("mouseleave",o.handlers.mouseleave)),o.observer&&o.observer.disconnect(),window.ratingState.delete(e),e.removeAttribute("data-rating-initialized"))}function m(e=document){e instanceof Element&&e.matches("[data-rating-component]")&&v(e),e&&typeof e.querySelectorAll=="function"&&e.querySelectorAll("[data-rating-component]").forEach(v)}window.templUI||(window.templUI={}),window.templUI.rating={initAllComponents:m},document.addEventListener("DOMContentLoaded",()=>m())})();})();
